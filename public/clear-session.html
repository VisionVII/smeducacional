<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Limpar Cookies - SM Educacional</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
      text-align: center;
    }

    .card {
      background: white;
      border-radius: 8px;
      padding: 40px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    h1 {
      color: #dc2626;
      margin-bottom: 20px;
    }

    button {
      padding: 12px 24px;
      margin: 10px;
      background: #dc2626;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
    }

    button:hover {
      background: #b91c1c;
    }

    .success {
      background: #dcfce7;
      border: 2px solid #22c55e;
      padding: 20px;
      border-radius: 4px;
      margin-top: 20px;
      display: none;
    }

    .link {
      display: inline-block;
      margin-top: 20px;
      padding: 10px 20px;
      background: #3b82f6;
      color: white;
      text-decoration: none;
      border-radius: 4px;
    }
  </style>
</head>

<body>
  <div class="card">
    <h1>üßπ Limpar Sess√£o Corrompida</h1>
    <p style="color: #666; margin-bottom: 30px;">
      Sua sess√£o est√° corrompida (role = undefined).<br>
      Clique no bot√£o abaixo para limpar todos os cookies e come√ßar do zero.
    </p>

    <button onclick="clearAllCookies()">Limpar Todos os Cookies</button>

    <div id="success" class="success">
      <h2 style="color: #22c55e; margin: 0 0 10px 0;">‚úÖ Cookies Limpos!</h2>
      <p style="margin: 0;">Voc√™ pode fechar esta aba e fazer login novamente.</p>
      <a href="http://localhost:3000/login" class="link">Ir para Login</a>
    </div>

    <div style="margin-top: 30px; padding: 15px; background: #fef3c7; border-radius: 4px;">
      <p style="margin: 0; font-size: 14px; color: #92400e;">
        <strong>Cookies encontrados:</strong><br>
        <span id="cookieList" style="font-family: monospace; font-size: 12px;"></span>
      </p>
    </div>
  </div>

  <script>
    // Mostrar cookies atuais
    document.getElementById('cookieList').textContent =
      document.cookie || '(nenhum cookie)';

    function clearAllCookies() {
      // Obter todos os cookies
      const cookies = document.cookie.split(";");

      // Deletar cada cookie em v√°rios dom√≠nios/paths
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i];
        const eqPos = cookie.indexOf("=");
        const name = eqPos > -1 ? cookie.substr(0, eqPos).trim() : cookie.trim();

        // Deletar com v√°rias combina√ß√µes de dom√≠nio e path
        const domains = ['', 'localhost', '.localhost', '127.0.0.1'];
        const paths = ['/', '/api', '/api/auth'];

        domains.forEach(domain => {
          paths.forEach(path => {
            document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=' + path +
              (domain ? ';domain=' + domain : '');
          });
        });
      }

      // Limpar localStorage e sessionStorage tamb√©m
      localStorage.clear();
      sessionStorage.clear();

      // Mostrar mensagem de sucesso
      document.getElementById('success').style.display = 'block';

      // Atualizar lista de cookies
      setTimeout(() => {
        document.getElementById('cookieList').textContent =
          document.cookie || '(nenhum cookie)';
      }, 500);

      console.log('‚úÖ Cookies, localStorage e sessionStorage limpos!');
    }
  </script>
</body>

</html>